import{a as Y}from"./request-9ab300ca.js";import{q as o,V as w,z as E,K as W,t as a,e as u,Y as P,E as I,g as S,v as g,P as M,x as N,y as m,G as j,H as p,S as Z,I as O,r as A,L as Q,O as X,R as _,T as $,U as z}from"./arcadeUtils-09cd4b60.js";import{p as s,a as b,w as C}from"./Extent-d21a2637.js";import{disjoint as nn,intersects as tn,touches as rn,crosses as en,within as an,contains as un,overlaps as cn,equals as ln,relate as fn,intersect as on,union as sn,difference as dn,symmetricDifference as mn,clip as wn,cut as pn,planarArea as q,geodesicArea as D,planarLength as L,geodesicLength as k,distance as hn,densify as H,geodesicDensify as J,generalize as yn,buffer as gn,geodesicBuffer as vn,offset as Pn,rotate as T,simplify as B,isSimple as In,convexHull as An}from"./geometryEngineAsync-9376c560.js";import{m as F,v as R,u as K}from"./Polyline-98ddf509.js";import{v as U}from"./jsonUtils-7333a4d1.js";import{$ as Fn}from"./unitUtils-bc71b997.js";import"./preload-helper-6c8d3039.js";import"./Error-8814705f.js";import"./string-cc430a78.js";import"./typedArrayUtil-bd69bba0.js";import"./promiseUtils-ec14a623.js";import"./geometry-da69b92c.js";import"./ensureType-9613b5f0.js";import"./typeUtils-98cd71e2.js";import"./jsonMap-9318d50f.js";import"./number-744902c4.js";import"./locale-30120714.js";import"./Field-27137e22.js";import"./cast-4943406f.js";import"./nextTick-3ee5a785.js";import"./enumeration-1740c98c.js";import"./fieldType-ff12d8db.js";import"./featureConversionUtils-e981d065.js";import"./OptimizedFeature-ec32193d.js";import"./OptimizedFeatureSet-1d1ac4b9.js";import"./Portal-c85307b1.js";import"./Loadable-8b974e55.js";import"./Promise-9613afa4.js";import"./PortalGroup-e30a1480.js";import"./PortalUser-6c405f61.js";import"./sizeVariableUtils-d4870b0d.js";import"./workers-a88acec1.js";import"./Connection-2ff63c33.js";import"./Queue-f6edac75.js";import"./assets-2905a8db.js";import"./intl-e6f005e0.js";import"./number-d7fe9942.js";import"./messages-d8933302.js";function V(e){return Y.indexOf("4.")===0?R.fromExtent(e):new R({spatialReference:e.spatialReference,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]})}function v(e,t,r){if(w(e,2,2,t,r),!(e[0]instanceof s&&e[1]instanceof s)){if(!(e[0]instanceof s&&e[1]===null)){if(!(e[1]instanceof s&&e[0]===null)){if(e[0]!==null||e[1]!==null)throw new a(t,u.InvalidParameter,r)}}}}async function G(e,t){if(e.type!=="polygon"&&e.type!=="polyline"&&e.type!=="extent")return 0;let r=1;(e.spatialReference.vcsWkid||e.spatialReference.latestVcsWkid)&&(r=$(e.spatialReference)/Fn(e.spatialReference));let l=0;if(e.type==="polyline")for(const n of e.paths)for(let i=1;i<n.length;i++)l+=z(n[i],n[i-1],r);else if(e.type==="polygon")for(const n of e.rings){for(let i=1;i<n.length;i++)l+=z(n[i],n[i-1],r);(n[0][0]!==n[n.length-1][0]||n[0][1]!==n[n.length-1][1]||n[0][2]!==void 0&&n[0][2]!==n[n.length-1][2])&&(l+=z(n[0],n[n.length-1],r))}else e.type==="extent"&&(l+=2*z([e.xmin,e.ymin,0],[e.xmax,e.ymin,0],r),l+=2*z([e.xmin,e.ymin,0],[e.xmin,e.ymax,0],r),l*=2,l+=4*Math.abs(m(e.zmax,0)*r-m(e.zmin,0)*r));const f=new F({hasZ:!1,hasM:!1,spatialReference:e.spatialReference,paths:[[0,0],[0,l]]});return L(f,t)}function ft(e){e.mode==="async"&&(e.functions.disjoint=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>(v(n=o(n),t,r),n[0]===null||n[1]===null||nn(n[0],n[1])))},e.functions.intersects=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>(v(n=o(n),t,r),n[0]!==null&&n[1]!==null&&tn(n[0],n[1])))},e.functions.touches=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>(v(n=o(n),t,r),n[0]!==null&&n[1]!==null&&rn(n[0],n[1])))},e.functions.crosses=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>(v(n=o(n),t,r),n[0]!==null&&n[1]!==null&&en(n[0],n[1])))},e.functions.within=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>(v(n=o(n),t,r),n[0]!==null&&n[1]!==null&&an(n[0],n[1])))},e.functions.contains=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>(v(n=o(n),t,r),n[0]!==null&&n[1]!==null&&un(n[0],n[1])))},e.functions.overlaps=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>(v(n=o(n),t,r),n[0]!==null&&n[1]!==null&&cn(n[0],n[1])))},e.functions.equals=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>(w(n,2,2,t,r),n[0]===n[1]||(n[0]instanceof s&&n[1]instanceof s?ln(n[0],n[1]):!(!E(n[0])||!E(n[1]))&&n[0].getTime()===n[1].getTime())))},e.functions.relate=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(n=o(n),w(n,3,3,t,r),n[0]instanceof s&&n[1]instanceof s)return fn(n[0],n[1],W(n[2]));if(n[0]instanceof s&&n[1]===null||n[1]instanceof s&&n[0]===null||n[0]===null&&n[1]===null)return!1;throw new a(t,u.InvalidParameter,r)})},e.functions.intersection=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>(v(n=o(n),t,r),n[0]===null||n[1]===null?null:on(n[0],n[1])))},e.functions.union=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{const i=[];if((n=o(n)).length===0)throw new a(t,u.WrongNumberOfParameters,r);if(n.length===1)if(P(n[0])){const c=o(n[0]);for(let d=0;d<c.length;d++)if(c[d]!==null){if(!(c[d]instanceof s))throw new a(t,u.InvalidParameter,r);i.push(c[d])}}else{if(!I(n[0])){if(n[0]instanceof s)return S(g(n[0]),t.spatialReference);if(n[0]===null)return null;throw new a(t,u.InvalidParameter,r)}{const c=o(n[0].toArray());for(let d=0;d<c.length;d++)if(c[d]!==null){if(!(c[d]instanceof s))throw new a(t,u.InvalidParameter,r);i.push(c[d])}}}else for(let c=0;c<n.length;c++)if(n[c]!==null){if(!(n[c]instanceof s))throw new a(t,u.InvalidParameter,r);i.push(n[c])}return i.length===0?null:sn(i)})},e.functions.difference=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>(v(n=o(n),t,r),n[0]!==null&&n[1]===null?g(n[0]):n[0]===null?null:dn(n[0],n[1])))},e.functions.symmetricdifference=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>(v(n=o(n),t,r),n[0]===null&&n[1]===null?null:n[0]===null?g(n[1]):n[1]===null?g(n[0]):mn(n[0],n[1])))},e.functions.clip=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(n=o(n),w(n,2,2,t,r),!(n[1]instanceof b)&&n[1]!==null)throw new a(t,u.InvalidParameter,r);if(n[0]===null)return null;if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);return n[1]===null?null:wn(n[0],n[1])})},e.functions.cut=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(n=o(n),w(n,2,2,t,r),!(n[1]instanceof F)&&n[1]!==null)throw new a(t,u.InvalidParameter,r);if(n[0]===null)return[];if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);return n[1]===null?[g(n[0])]:pn(n[0],n[1])})},e.functions.area=function(t,r){return e.standardFunctionAsync(t,r,async(l,f,n)=>{if(w(n,1,2,t,r),(n=o(n))[0]===null)return 0;if(M(n[0])){const i=await n[0].sumArea(N(m(n[1],-1)),!1,t.abortSignal);if(t.abortSignal.aborted)throw new a(t,u.Cancelled,r);return i}if(P(n[0])||I(n[0])){const i=j(n[0],t.spatialReference);return i===null?0:q(i,N(m(n[1],-1)))}if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);return q(n[0],N(m(n[1],-1)))})},e.functions.areageodetic=function(t,r){return e.standardFunctionAsync(t,r,async(l,f,n)=>{if(w(n,1,2,t,r),(n=o(n))[0]===null)return 0;if(M(n[0])){const i=await n[0].sumArea(N(m(n[1],-1)),!0,t.abortSignal);if(t.abortSignal.aborted)throw new a(t,u.Cancelled,r);return i}if(P(n[0])||I(n[0])){const i=j(n[0],t.spatialReference);return i===null?0:D(i,N(m(n[1],-1)))}if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);return D(n[0],N(m(n[1],-1)))})},e.functions.length=function(t,r){return e.standardFunctionAsync(t,r,async(l,f,n)=>{if(w(n,1,2,t,r),(n=o(n))[0]===null)return 0;if(M(n[0])){const i=await n[0].sumLength(p(m(n[1],-1)),!1,t.abortSignal);if(t.abortSignal.aborted)throw new a(t,u.Cancelled,r);return i}if(P(n[0])||I(n[0])){const i=Z(n[0],t.spatialReference);return i===null?0:L(i,p(m(n[1],-1)))}if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);return L(n[0],p(m(n[1],-1)))})},e.functions.length3d=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(w(n,1,2,t,r),(n=o(n))[0]===null)return 0;if(P(n[0])||I(n[0])){const i=Z(n[0],t.spatialReference);return i===null?0:i.hasZ===!0?G(i,p(m(n[1],-1))):L(i,p(m(n[1],-1)))}if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);return n[0].hasZ===!0?G(n[0],p(m(n[1],-1))):L(n[0],p(m(n[1],-1)))})},e.functions.lengthgeodetic=function(t,r){return e.standardFunctionAsync(t,r,async(l,f,n)=>{if(w(n,1,2,t,r),(n=o(n))[0]===null)return 0;if(M(n[0])){const i=await n[0].sumLength(p(m(n[1],-1)),!0,t.abortSignal);if(t.abortSignal.aborted)throw new a(t,u.Cancelled,r);return i}if(P(n[0])||I(n[0])){const i=Z(n[0],t.spatialReference);return i===null?0:k(i,p(m(n[1],-1)))}if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);return k(n[0],p(m(n[1],-1)))})},e.functions.distance=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{n=o(n),w(n,2,3,t,r);let i=n[0];(P(n[0])||I(n[0]))&&(i=O(n[0],t.spatialReference));let c=n[1];if((P(n[1])||I(n[1]))&&(c=O(n[1],t.spatialReference)),!(i instanceof s))throw new a(t,u.InvalidParameter,r);if(!(c instanceof s))throw new a(t,u.InvalidParameter,r);return hn(i,c,p(m(n[2],-1)))})},e.functions.distancegeodetic=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{n=o(n),w(n,2,3,t,r);const i=n[0],c=n[1];if(!(i instanceof C))throw new a(t,u.InvalidParameter,r);if(!(c instanceof C))throw new a(t,u.InvalidParameter,r);const d=new F({paths:[],spatialReference:i.spatialReference});return d.addPath([i,c]),k(d,p(m(n[2],-1)))})},e.functions.densify=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(n=o(n),w(n,2,3,t,r),n[0]===null)return null;if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);const i=A(n[1]);if(isNaN(i))throw new a(t,u.InvalidParameter,r);if(i<=0)throw new a(t,u.InvalidParameter,r);return n[0]instanceof R||n[0]instanceof F?H(n[0],i,p(m(n[2],-1))):n[0]instanceof b?H(V(n[0]),i,p(m(n[2],-1))):n[0]})},e.functions.densifygeodetic=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(n=o(n),w(n,2,3,t,r),n[0]===null)return null;if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);const i=A(n[1]);if(isNaN(i))throw new a(t,u.InvalidParameter,r);if(i<=0)throw new a(t,u.InvalidParameter,r);return n[0]instanceof R||n[0]instanceof F?J(n[0],i,p(m(n[2],-1))):n[0]instanceof b?J(V(n[0]),i,p(m(n[2],-1))):n[0]})},e.functions.generalize=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(n=o(n),w(n,2,4,t,r),n[0]===null)return null;if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);const i=A(n[1]);if(isNaN(i))throw new a(t,u.InvalidParameter,r);return yn(n[0],i,Q(m(n[2],!0)),p(m(n[3],-1)))})},e.functions.buffer=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(n=o(n),w(n,2,3,t,r),n[0]===null)return null;if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);const i=A(n[1]);if(isNaN(i))throw new a(t,u.InvalidParameter,r);return i===0?g(n[0]):gn(n[0],i,p(m(n[2],-1)))})},e.functions.buffergeodetic=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(n=o(n),w(n,2,3,t,r),n[0]===null)return null;if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);const i=A(n[1]);if(isNaN(i))throw new a(t,u.InvalidParameter,r);return i===0?g(n[0]):vn(n[0],i,p(m(n[2],-1)))})},e.functions.offset=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(n=o(n),w(n,2,6,t,r),n[0]===null)return null;if(!(n[0]instanceof R||n[0]instanceof F))throw new a(t,u.InvalidParameter,r);const i=A(n[1]);if(isNaN(i))throw new a(t,u.InvalidParameter,r);const c=A(m(n[4],10));if(isNaN(c))throw new a(t,u.InvalidParameter,r);const d=A(m(n[5],0));if(isNaN(d))throw new a(t,u.InvalidParameter,r);return Pn(n[0],i,p(m(n[2],-1)),W(m(n[3],"round")).toLowerCase(),c,d)})},e.functions.rotate=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{n=o(n),w(n,2,3,t,r);let i=n[0];if(i===null)return null;if(!(i instanceof s))throw new a(t,u.InvalidParameter,r);i instanceof b&&(i=R.fromExtent(i));const c=A(n[1]);if(isNaN(c))throw new a(t,u.InvalidParameter,r);const d=m(n[2],null);if(d===null)return T(i,c);if(d instanceof C)return T(i,c,d);throw new a(t,u.InvalidParameter,r)})},e.functions.centroid=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(n=o(n),w(n,1,1,t,r),n[0]===null)return null;let i=n[0];if((P(n[0])||I(n[0]))&&(i=O(n[0],t.spatialReference)),i===null)return null;if(!(i instanceof s))throw new a(t,u.InvalidParameter,r);return i instanceof C?S(g(n[0]),t.spatialReference):i instanceof R?i.centroid:i instanceof F?X(i):i instanceof K?_(i):i instanceof b?i.center:null})},e.functions.multiparttosinglepart=function(t,r){return e.standardFunctionAsync(t,r,async(l,f,n)=>{n=o(n),w(n,1,1,t,r);const i=[];if(n[0]===null)return null;if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);if(n[0]instanceof C)return[S(g(n[0]),t.spatialReference)];if(n[0]instanceof b)return[S(g(n[0]),t.spatialReference)];const c=await B(n[0]);if(c instanceof R){const d=[],y=[];for(let h=0;h<c.rings.length;h++)if(c.isClockwise(c.rings[h])){const x=U({rings:[c.rings[h]],hasZ:c.hasZ===!0,hazM:c.hasM===!0,spatialReference:c.spatialReference.toJSON()});d.push(x)}else y.push({ring:c.rings[h],pt:c.getPoint(h,0)});for(let h=0;h<y.length;h++)for(let x=0;x<d.length;x++)if(d[x].contains(y[h].pt)){d[x].addRing(y[h].ring);break}return d}if(c instanceof F){const d=[];for(let y=0;y<c.paths.length;y++){const h=U({paths:[c.paths[y]],hasZ:c.hasZ===!0,hazM:c.hasM===!0,spatialReference:c.spatialReference.toJSON()});d.push(h)}return d}if(n[0]instanceof K){const d=S(g(n[0]),t.spatialReference);for(let y=0;y<d.points.length;y++)i.push(d.getPoint(y));return i}return null})},e.functions.issimple=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(n=o(n),w(n,1,1,t,r),n[0]===null)return!0;if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);return In(n[0])})},e.functions.simplify=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(n=o(n),w(n,1,1,t,r),n[0]===null)return null;if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);return B(n[0])})},e.functions.convexhull=function(t,r){return e.standardFunctionAsync(t,r,(l,f,n)=>{if(n=o(n),w(n,1,1,t,r),n[0]===null)return null;if(!(n[0]instanceof s))throw new a(t,u.InvalidParameter,r);return An(n[0])})})}export{ft as registerFunctions};
